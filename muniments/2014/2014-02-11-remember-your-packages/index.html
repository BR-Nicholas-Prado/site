<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="casey@caseykuhlman.com Casey Kuhlman"><meta name=description content="What programs (packages) do I use? This is a perennial problem. It is always easy to remember those packages you use all the time but what about those packages that you do not but you want them there when you need them. Here is a three step system for ensuring that you never forget to reinstall packages you want when you upgrade your system or reinstall you operating system."><meta name=keywords content="legaltech,resilience,authoritarianism,linux,packages"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://caseykuhlman.com/muniments/2014/2014-02-11-remember-your-packages/><title>Remembering Your Packages :: underWater desert Blogging â€” A Site About Resilience and Authoritarianism</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.min.753fac8f03736f0edc9be411eb20cee875dd7bb8e73c8155fbf6a629c863f4ca.css><meta itemprop=name content="Remembering Your Packages"><meta itemprop=description content="What programs (packages) do I use? This is a perennial problem. It is always easy to remember those packages you use all the time but what about those packages that you do not but you want them there when you need them. Here is a three step system for ensuring that you never forget to reinstall packages you want when you upgrade your system or reinstall you operating system."><meta itemprop=datePublished content="2014-02-11T00:00:00+00:00"><meta itemprop=dateModified content="2020-05-13T19:31:11+01:00"><meta itemprop=wordCount content="967"><meta itemprop=image content="https://caseykuhlman.com/img/udp.jpg"><meta itemprop=keywords content="linux,packages,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://caseykuhlman.com/img/udp.jpg"><meta name=twitter:title content="Remembering Your Packages"><meta name=twitter:description content="What programs (packages) do I use? This is a perennial problem. It is always easy to remember those packages you use all the time but what about those packages that you do not but you want them there when you need them. Here is a three step system for ensuring that you never forget to reinstall packages you want when you upgrade your system or reinstall you operating system."><meta property="article:section" content="Linux for Lawyers"><meta property="article:published_time" content="2014-02-11 00:00:00 +0000 UTC"></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>cd ~/</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://caseykuhlman.com/posts>Entries</a></li><li><a href=https://caseykuhlman.com/about>Me, About</a></li><li><a href=https://caseykuhlman.com/muniments>Muniments</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://caseykuhlman.com/muniments/2014/2014-02-11-remember-your-packages/>Remembering Your Packages</a></h2><div class=post-content><p>What programs (packages) do I use? This is a perennial problem. It is always easy to remember those packages you use all the time but what about those packages that you do not but you want them there when you need them. Here is a three step system for ensuring that you never forget to reinstall packages you want when you upgrade your system or reinstall you operating system.</p><h2 id=step-1----build-an-install-script>Step 1 &ndash; Build an Install Script</h2><p>I have slowly been speaking about the parts of my installation script over the course of most of my Linux for Lawyers series. I have written about how to use <a href=http://coda.caseykuhlman.com//entries/2014/dropbox-as-a-settings-repository.html>Dropbox as a settings repository</a> and to automatically pull those settings in when you reinstall your system and I have also written about setting up your <a href=http://coda.caseykuhlman.com//entries/2014/on-shells.html>shell environment</a>. The system that I use depends in large part on a fairly detailed installation script that I use after installing or reinstalling a Linux operating system. So I keep my packages in that install script.</p><p>My install script contains a long list of the packages which I have installed previously. This is held in an array in shell scripting format. Then the install script builds a function which is creatively called <code>install_a_bunch</code>. Shell scripting is not terribly easy to follow along with, but what the function essentially does is to first check if the packages I'm trying to install are already installed. Based on the return of the sudo apt-get &ndash;qq &ndash;dry-run call, it parses the packages into three buckets. The first bucket contains those packages which are not installed and can be found in the repositories. The second bucket contains those packages which are already installed. The third bucket contains those packages which cannot be found in the repositories. The final thing the function does is to install those packages which are in the first bucket.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pkgs<span style=color:#f92672>=</span><span style=color:#f92672>(</span> alacarte audacity blueman chromium-browser cifs-utils conky ..<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>.. zotero-standalone zsh <span style=color:#f92672>)</span>

<span style=color:#66d9ef>function</span> install_a_bunch<span style=color:#f92672>(</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
  rqst_pkgs<span style=color:#f92672>=</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>@<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>)</span>
  pkgs_inst<span style=color:#f92672>=</span><span style=color:#f92672>(</span> <span style=color:#f92672>)</span>
  <span style=color:#66d9ef>for</span> pkg in <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>rqst_pkgs[@]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>; <span style=color:#66d9ef>do</span>
    echo <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>checking for package: </span>$pkg<span style=color:#e6db74>&#34;</span>
    sudo apt-get -qq --dry-run install $pkg &amp;&gt;/dev/null
    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> $? !<span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>  <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
      dpkg -s $pkg 2&gt;/dev/null | grep -q installed
      <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> $? <span style=color:#f92672>=</span><span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
        pkgs_inst<span style=color:#f92672>=</span><span style=color:#f92672>(</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>pkgs_inst[@]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>pkg<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>)</span>
        echo <span style=color:#e6db74>&#34;</span>$pkg<span style=color:#e6db74>: not installed, will install it.</span><span style=color:#e6db74>&#34;</span>
      <span style=color:#66d9ef>else</span>
        echo <span style=color:#e6db74>&#34;</span>$pkg<span style=color:#e6db74>: already installed.</span><span style=color:#e6db74>&#34;</span>
      <span style=color:#66d9ef>fi</span>
    <span style=color:#66d9ef>else</span>
      echo <span style=color:#e6db74>&#34;</span>$pkg<span style=color:#e6db74>: cannot find in the repos, try checking the apt repositories</span><span style=color:#e6db74>&#34;</span>
    <span style=color:#66d9ef>fi</span>
  <span style=color:#66d9ef>done</span>
  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span><span style=color:#f92672>[</span> ! <span style=color:#e6db74>${#</span>pkgs_inst[@]<span style=color:#e6db74>}</span> <span style=color:#f92672>=</span><span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span><span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
    sudo apt-get install -y <span style=color:#e6db74>${</span>pkgs_inst[@]<span style=color:#e6db74>}</span>
  <span style=color:#66d9ef>else</span>
    echo <span style=color:#e6db74>&#34;nothing to install&#34;</span>
  <span style=color:#66d9ef>fi</span>
<span style=color:#f92672>}</span>
install_a_bunch <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>pkgs[@]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</code></pre></div><p>Linux package managers are decentralized things. This means that you can add and remove other package repositories besides the ones that come pre-installed with the system. In Ubuntu this is done with the add-apt-repository command. The third bucket was put in because many of the packages / programs I use are installed not from the standard repositories but from specialized repositories. In Ubuntu, many packages that are in the standard Ubuntu repositories may be a ways behind the package's latest stable release so it is often necessary to add other repositories which point to the latest stable releases rather than using the standard Ubuntu releases. For example, as of this writing, LibreOffice version 4.1.2 is what is sourced from the standard repositories while version 4.2.0 is sourced from the LibreOffice repositories. For that package and others, I will use the specialized repository rather than the standard repository.</p><h2 id=step-2----setup-your-shell-to-log-repositories-and-packages>Step 2 &ndash; Setup Your Shell to Log Repositories and Packages</h2><p>Once you have an install script ready to go, then the next step is to set up your shell with shortcuts that you can use to both add a repository and install packages while also logging what you are adding into the install script.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#66d9ef>function</span> install<span style=color:#f92672>(</span><span style=color:#f92672>)</span>
<span style=color:#f92672>{</span>
  packages<span style=color:#f92672>=</span>$@
  sudo apt-get install <span style=color:#e6db74>${</span>=packages<span style=color:#e6db74>}</span> <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;</span>$packages<span style=color:#e6db74>&#34;</span> &gt;&gt; ~/.installd
<span style=color:#f92672>}</span>
apt_pref_compdef install  <span style=color:#e6db74>&#34;install&#34;</span>
<span style=color:#66d9ef>function</span> add-repo<span style=color:#f92672>(</span><span style=color:#f92672>)</span>
<span style=color:#f92672>{</span>
  repos<span style=color:#f92672>=</span>$@
  sudo add-apt-repository -y ppa:<span style=color:#e6db74>${</span>=repos<span style=color:#e6db74>}</span> <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>sudo add-apt-repository -y ppa:</span>$repos<span style=color:#e6db74>&#34;</span> &gt;&gt; ~/.installd
  sudo apt-get update
<span style=color:#f92672>}</span>
</code></pre></div><p>The first function above, <code>install</code>, is used so that when I'm copying and pasting from a site which tells me to do a sudo apt-get install that I just can copy the install and whatever packages I'm to install. The function will do a sudo apt-get install of the packages and then will log those packages in the install script. The line after the install function is a compdef function which enables tab completion in zsh.</p><p>The second function above, <code>add-repo</code>, is a corollary of the install function. It performs an add-apt-repository call and then logs that in the install script. Finally it performs a sudo apt-get update which you always want to do after you add a repository so that the Ubuntu list of packages gets updated with the packages from the new repository.</p><h2 id=step-3----keep-it-organized>Step 3 &ndash; Keep It Organized</h2><p>The logging functions above will put new repositories and packages at the end of your install script (note, adding onto the end of a text file in shell is super easy with the <code>echo "BLAH" >> FILE</code> call). Then every once in a while I just organize the script. I cut and paste the repositories into the proper place in my install script and then I use ruby to organize the packages.</p><p>If you have ruby installed on your computer then from shell you type <code>irb</code>. This will load the interactive ruby console. After that, here is what I do (note the $ below is the cursor):</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#960050;background-color:#1e0010>$</span> a <span style=color:#f92672>=</span> <span style=color:#e6db74>%w(</span><span style=color:#e6db74>_CUT_AND_PASTE_THE_PACKAGES_FROM_PKGS_IN_INSTALL_SCRIPT_</span><span style=color:#e6db74>)</span>
<span style=color:#960050;background-color:#1e0010>$</span> a <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>%w(</span><span style=color:#e6db74>_CUT_AND_PASTE_THE_PACKAGES_FROM_THE_BOTTOM_OF_INSTALL_SCRIPT_</span><span style=color:#e6db74>)</span>
<span style=color:#960050;background-color:#1e0010>$</span> a<span style=color:#f92672>.</span>flatten<span style=color:#f92672>.</span>sort<span style=color:#f92672>.</span>uniq<span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39; &#39;</span>)
<span style=color:#960050;background-color:#1e0010>$</span> exit
</code></pre></div><p>Then just copy the output from the final ruby call there into your packages array in the install script and delete the packages from the bottom. Then you are all set. You have all your packages logged and up to date.</p><p>Happy Hacking!</p><p>~ # ~</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://caseykuhlman.com/tags/linux>linux</a></span><span class=tag><a href=https://caseykuhlman.com/tags/packages>packages</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"/><line x1="1.05" y1="12" x2="7" y2="12"/><line x1="17.01" y1="12" x2="22.96" y2="12"/></svg><a href=https://github.com/compleatang/site/commit/de7bce68e9732662cf3fc7dffb543d5aa734dc8a target=_blank rel=noopener>de7bce6</a> @ 2020-05-13</p></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2020</span>
<span><a href=https://caseykuhlman.com/>Casey Kuhlman</a></span>
<span>All Content Licensed CC BY-NC-SA 4.0</span>
<span><a href=https://caseykuhlman.com/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Made with &#10084; by <a href=https://github.com/rhazdon>Djordje Atlialp</a></span></div></div></footer></div><script type=text/javascript src=/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js integrity="sha512-3HFukJLJggt3+W2ilNASCu6xibW86pdSMJ6+on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script><script src=//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js></script><script src=/js/udb.js></script><script src=//static.getclicky.com/js></script></body></html>