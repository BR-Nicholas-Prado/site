<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="casey@caseykuhlman.com Casey Kuhlman"><meta name=description content="Conky is a wonderful addition to your Linux desktop. It is a very lightweight system monitoring application which can be designed to look very different to fit your style. Here's my setup."><meta name=keywords content="legaltech,resilience,authoritarianism,linux,conky,system monitoring"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://caseykuhlman.com/muniments/2014/2014-02-05-on-conky/><title>Conky -- Smooth Operations :: underWater desert Blogging â€” A Site About Resilience and Authoritarianism</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.min.84ed5579024525d4b50458514d1a43e40dd5272df45c7cd6da85b225af457154.css><meta itemprop=name content="Conky -- Smooth Operations"><meta itemprop=description content="Conky is a wonderful addition to your Linux desktop. It is a very lightweight system monitoring application which can be designed to look very different to fit your style. Here's my setup."><meta itemprop=datePublished content="2014-02-05T00:00:00+00:00"><meta itemprop=dateModified content="2020-04-12T00:06:38+01:00"><meta itemprop=wordCount content="1495"><meta itemprop=image content="https://caseykuhlman.com/img/udp.jpg"><meta itemprop=keywords content="linux,conky,system monitoring,"><meta property="og:title" content="Conky -- Smooth Operations"><meta property="og:description" content="Conky is a wonderful addition to your Linux desktop. It is a very lightweight system monitoring application which can be designed to look very different to fit your style. Here's my setup."><meta property="og:type" content="article"><meta property="og:url" content="https://caseykuhlman.com/muniments/2014/2014-02-05-on-conky/"><meta property="og:image" content="https://caseykuhlman.com/img/udp.jpg"><meta property="article:published_time" content="2014-02-05T00:00:00+00:00"><meta property="article:modified_time" content="2020-04-12T00:06:38+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://caseykuhlman.com/img/udp.jpg"><meta name=twitter:title content="Conky -- Smooth Operations"><meta name=twitter:description content="Conky is a wonderful addition to your Linux desktop. It is a very lightweight system monitoring application which can be designed to look very different to fit your style. Here's my setup."><meta property="article:section" content="Linux for Lawyers"><meta property="article:published_time" content="2014-02-05 00:00:00 +0000 UTC"></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>cd ~/</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://caseykuhlman.com/posts>Entries</a></li><li><a href=https://caseykuhlman.com/about>Me, About</a></li><li><a href=https://caseykuhlman.com/muniments>Muniments</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://caseykuhlman.com/muniments/2014/2014-02-05-on-conky/>Conky &ndash; Smooth Operations</a></h2><div class=post-content><p><a href=http://conky.sourceforge.net>Conky</a> is a tool I have used since about the time I started using Linux. It is a great piece of kit. When you first start using Conky it can be a bit overwhelming because it has a ton of options and configuring it is not terribly straight forward for those who do not like command line and editing files. But once you get over the initial hump it is amazing. It is a set and forget tool that I have used for years with very little modification once I had my initial set up. Here is what my current setup looks like:</p><p>I know what the different rings mean, but no one else does. So as a way of introduction the rings are as follows:</p><ol><li>Clock.</li><li>Processor load (I have an i9 processor with 8 cores so that is why there are eight half concentric rings layered into one ring).</li><li>Memory load (outside) | Battery charge (inside).</li><li>Network traffic (left side outer is outbound via ethernet, left inner is inbound via ethernet, right side outer is outbound via wireless, right side inner is inbound via wireless) | Network ports (deep inner).</li><li>Drives (percent used on various drives).</li></ol><p>On <a href=https://github.com/compleatang/Conky>this page</a> you can see how my conky looks with other wallpapers.</p><h2 id=setting-up-conky>Setting up Conky</h2><p>In Ubuntu, Conky is in the main repositories so it is very straight forward to install:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ sudo apt-get install conky
</code></pre></div><p>When the installation finishes you will be all set up. If you prefer a GUI to set up your conky with some pretty good looking initial themes, then I would encourage you to read this article over at <a href=http://wsl.so/1gLQnQH>WebUPD8</a> and follow the instructions for installing conky manager.</p><p>I prefer to fork and modify other people's open source code and so that is what the rest of this tutorial will work towards. To get an idea of the different things that you can do with conky I would encourage you to glance at the above article first, and then go over to DeviantArt and look through the <a href=http://wsl.so/1gLQJ9R>Conky galleries</a>. I originally did this but have heavily modified my theme which was originally based on <a href=http://wsl.so/1gLR7Fv>work</a> by <a href=http://wsl.so/1gLR8Jr>LondonAli at DeviantArt</a>. She has some beautiful conky themes she has built and her gallery is well worth pursuing.</p><p>If you find a theme which you like then you simply download the .zip file and extract it into your <code>~/.conky</code> folder. Generally to do this, I right click on the Download link on the top of the right sidebar in DeviantArt, then Copy Link. After that, in terminal I type:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ cd ~/.conky
$ wget -O conky.tgz $PASTE_LINK_WITH_CTRL_SHIFT_V
$ tar -xzvf conky.tgz
</code></pre></div><p>Or, if it is a zip download</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ cd ~/.conky
$ wget -O conky.zip $PASTE_LINK_WITH_CTRL_SHIFT_V
$ unzip conky
</code></pre></div><p>Once the files are extracted into your conky folder then you will want to cd into that directory and look at what you actually have. If all the files extracted into their own directory, I generally will move them back to the normal conky directory. Now, you are ready to start conky. I use the command line when I'm testing conky because you will be wanting to stop and restart it as you make hacks along the way.</p><p>In the command line again, the command to start conky is simple:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ conky -c $CONKY_RC_FILE
</code></pre></div><p>Then, when you want to stop it you simply type <code>CTRL+C</code> when you are in your terminal. (By the by, ctrl+c in a terminal is cancel. This is why in terminal you need to type ctrl+SHIFT+c to copy something. This is a bit confusing and I've been thinking I need to change this default (which you can always do by modifying your shell config files) but haven't yet done it.)</p><p>When I was starting with Conky, I downloaded many conky configs from DeviantArt and then started conky with one, then stopped it and started it again with another, etc. until I found the one that I liked. So when you extract the archive you downloaded from DeviantArt usually you will want to see that the different conkyrc files have different names so that you can try different ones on your desktop.</p><p>On more sophisticated setups there are two files that conky will need, a conkyrc file which is the main file and a lua file which is used to draw cool shapes and sizes. Here is my conkyrc file. If you want to see my conky.lua file it is available <a href=https://github.com/compleatang/Conky/blob/master/conky.lua>here</a>.</p><pre><code>#--- Conkyrc, Originally by londonali1010, modified by compleatang ---#
background no
net_avg_samples 2
cpu_avg_samples 2
no_buffers yes
double_buffer yes
update_interval 1.0
default_color 467159

own_window yes
own_window_type normal
own_window_class conky
own_window_hints undecorated,skip_taskbar,skip_pager,sticky,below
own_window_transparent no
own_window_argb_visual yes
own_window_argb_value 0

border_inner_margin 0
border_outer_margin 0
default_outline_color white
default_shade_color white
draw_borders no
draw_graph_borders yes
stippled_borders 0
draw_outline no
draw_shades no
draw_shadows no
show_graph_scale no
show_graph_range no

use_xft yes
xftfont Sawasdee:size=24
xftalpha 0.8
uppercase no

minimum_size 1366 300
maximum_width 1366
use_spacer none
alignment tm
gap_x 0
gap_y 50

lua_load ~/.conky/conky.lua
lua_draw_hook_pre conky_widgets

TEXT
${voffset 100}${alignc}${time %A, %d %B %Y}
</code></pre><p>Once you have those installed and modified to your liking you are more or less all set.</p><h2 id=take-your-conky-to-the-next-level-with-auto-colors>Take Your Conky to the Next Level with Auto-Colors</h2><p>I was interested in seeing if I could modify my conky to automatically pick colors that complement my wallpaper and I wanted it to run whenever I changed my wallpaper. This is a hack to be sure, but it works on Ubuntu at least. One of the things that Ubuntu (or Gnome, am not sure) does is when you tell it there is a new wallpaper but pick a file from a different location, it will copy that file into the ~/Wallpapers folder. I keep my wallpapers in my Dropbox so what I did was to set up a ruby process that watches the Wallpapers folder and when a new file is added, it modifies conky for me.</p><p>The ruby file is pretty straight forward, but to use it you will have to install two gems with <code>gem install listen miro</code>. After installing those gems, you are set.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#75715e>#!/usr/bin/env ruby</span>
require <span style=color:#e6db74>&#39;miro&#39;</span>
require <span style=color:#e6db74>&#39;listen&#39;</span>

<span style=color:#75715e># set defaults</span>
@conky_rc_file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/home/coda/.conky/conkyrc&#39;</span>
@conky_lua_file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/home/coda/.conky/conky.lua&#39;</span>
watch_dir <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/home/coda/Wallpapers&#39;</span>

<span style=color:#75715e># miro options</span>
<span style=color:#66d9ef>Miro</span><span style=color:#f92672>.</span>options<span style=color:#f92672>[</span><span style=color:#e6db74>:color_count</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>
<span style=color:#f92672></span><span style=color:#66d9ef>Miro</span><span style=color:#f92672>.</span>options<span style=color:#f92672>[</span><span style=color:#e6db74>:resolution</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;1500x1500&#39;</span>

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e></span><span style=color:#f92672></span><span style=color:#a6e22e>get_colors</span>(new_wallpaper)
  puts <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>getting colors for </span><span style=color:#e6db74>#{</span>new_wallpaper<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
  colors <span style=color:#f92672>=</span> <span style=color:#66d9ef>Miro</span><span style=color:#f92672>::</span><span style=color:#66d9ef>DominantColors</span><span style=color:#f92672>.</span>new(new_wallpaper)<span style=color:#f92672>.</span>to_hex<span style=color:#f92672>.</span>sort

  @conky_txt_color_default <span style=color:#f92672>=</span> colors<span style=color:#f92672>[</span><span style=color:#ae81ff>1</span><span style=color:#f92672></span><span style=color:#f92672>]</span><span style=color:#f92672>[</span><span style=color:#ae81ff>1</span><span style=color:#f92672></span><span style=color:#f92672>..</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#f92672></span><span style=color:#f92672>]</span>
  @conky_bg_color_default <span style=color:#f92672>=</span> colors<span style=color:#f92672>[</span><span style=color:#ae81ff>0</span><span style=color:#f92672></span><span style=color:#f92672>]</span><span style=color:#f92672>[</span><span style=color:#ae81ff>1</span><span style=color:#f92672></span><span style=color:#f92672>..</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#f92672></span><span style=color:#f92672>]</span>
  @conky_fg_color_default <span style=color:#f92672>=</span> colors<span style=color:#f92672>[</span><span style=color:#ae81ff>3</span><span style=color:#f92672></span><span style=color:#f92672>]</span><span style=color:#f92672>[</span><span style=color:#ae81ff>1</span><span style=color:#f92672></span><span style=color:#f92672>..</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#f92672></span><span style=color:#f92672>]</span>
<span style=color:#66d9ef>end</span>

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e></span><span style=color:#f92672></span><span style=color:#a6e22e>replace_colors_all</span> text, bg, fg
  system(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>sed &#39;-i&#39; &#39;s/default_color .*$/default_color </span><span style=color:#e6db74>#{</span>text<span style=color:#e6db74>}</span><span style=color:#e6db74>/&#39; </span><span style=color:#e6db74>#{</span>@conky_rc_file<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
  system(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>sed &#39;-i&#39; &#39;s/color_bg .*$/color_bg = 0x</span><span style=color:#e6db74>#{</span>bg<span style=color:#e6db74>}</span><span style=color:#e6db74>/&#39; </span><span style=color:#e6db74>#{</span>@conky_lua_file<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
  system(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>sed &#39;-i&#39; &#39;s/color_fg .*$/color_fg = 0x</span><span style=color:#e6db74>#{</span>fg<span style=color:#e6db74>}</span><span style=color:#e6db74>/&#39; </span><span style=color:#e6db74>#{</span>@conky_lua_file<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
<span style=color:#66d9ef>end</span>

listener <span style=color:#f92672>=</span> <span style=color:#66d9ef>Listen</span><span style=color:#f92672>.</span>to(watch_dir) <span style=color:#66d9ef>do</span> <span style=color:#f92672>|</span>modified, added, removed<span style=color:#f92672>|</span>
  <span style=color:#66d9ef>if</span> added<span style=color:#f92672>.</span>last
    get_colors(added<span style=color:#f92672>.</span>last)
    replace_colors_all(@conky_txt_color_default, @conky_bg_color_default, @conky_fg_color_default)
  <span style=color:#66d9ef>end</span>
<span style=color:#66d9ef>end</span>
listener<span style=color:#f92672>.</span>start
sleep
</code></pre></div><p>Since the conky deamon watches the conky files and will reload itself when the files are modified you do not have to add a restart command to restart conky. To make this run on startup and to stay running as a deamon in the background along with conky this is what I did. Another gem to install with <code>gem install foreman</code>. Then add a Procfile to the ~/.conky folder that looks like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#e6db74>conky_main</span>: <span style=color:#e6db74>/</span><span style=color:#e6db74>usr</span><span style=color:#e6db74>/</span>bin<span style=color:#f92672>/</span>conky <span style=color:#f92672>-</span>c <span style=color:#e6db74>/</span><span style=color:#e6db74>home</span><span style=color:#e6db74>/</span>coda<span style=color:#f92672>/</span><span style=color:#f92672>.</span>conky<span style=color:#f92672>/</span>conkyrc
<span style=color:#e6db74>conky_colors</span>: <span style=color:#e6db74>/</span><span style=color:#e6db74>home</span><span style=color:#e6db74>/</span>coda<span style=color:#f92672>/</span><span style=color:#f92672>.</span>conky<span style=color:#f92672>/</span>conky_colorsd
</code></pre></div><p>Lastly, I added a custom startup script:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>#!/usr/bin/env zsh
</span><span style=color:#75715e></span>source ~/.zshrc
foreman start -f /home/coda/.conky/Procfile &amp;
</code></pre></div><p>Once you add the startup script, you will need to make sure you can execute it with <code>chmod +x startup.sh</code> or whatever you call it. The final step is to call the startup script when you log into your computer by adding it to your Startup Applications. After that you are all set. The startup script will start foreman, which will start normal conky with the right conkyrc that you give to it and also the conky_colorsd deamon which will watch for wallpaper changes.</p><h2 id=further-customization>Further Customization</h2><p>The conky_colorsd daemon is OK. But sometimes it gets the colors wrong. Also if I used a Wallpaper from the ~/Wallpaper folder (one I've used before) or from the standard Ubuntu wallpapers, the daemon will not see those changes and will not run the modification script. So I also built a conky_colors which is executable. I symlink this into my ~/.bin folder so that I can always call <code>conky_colors</code> from the command line. The process for conky_colors is roughly the same, it will look at the Wallpaper that currently is there, find its primary colors and then allow me to pick which colors I want to use for the text, ring forground and ring background.</p><p>There is one minor hiccup in the miro gem which does not do well parsing files that have spaces in them. So sometimes when you change to a wallpaper and nothing happens, it could be because of that, running the manual script should solve that process.</p><p>Voila! A completely wonderful system.</p><h2 id=want-to-just-copy-me>Want to Just Copy Me?</h2><p>No problem as long as you have ruby installed on your system. Two steps and you're set:</p><ol><li><code>cd ~ && git clone https://github.com/compleatang/Conky.git .conky && gem install listen miro foreman</code></li><li>Add ~/.conky/startup.sh to your Startup Applications</li></ol><p>Happy Hacking!</p><p>~ # ~</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://caseykuhlman.com/tags/linux>linux</a></span><span class=tag><a href=https://caseykuhlman.com/tags/conky>conky</a></span><span class=tag><a href=https://caseykuhlman.com/tags/system-monitoring>system monitoring</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"/><line x1="1.05" y1="12" x2="7" y2="12"/><line x1="17.01" y1="12" x2="22.96" y2="12"/></svg><a href=https://github.com/compleatang/site/commit/429dc13262a637f33e15607e91d018462bcba13b target=_blank rel=noopener>429dc13</a> @ 2020-04-11</p></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2020</span>
<span><a href=https://caseykuhlman.com/>Casey Kuhlman</a></span>
<span>All Content Licensed CC BY-NC-SA 4.0</span>
<span><a href=https://caseykuhlman.com/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Made with &#10084; by <a href=https://github.com/rhazdon>Djordje Atlialp</a></span></div></div></footer></div><script type=text/javascript src=/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script><script src=//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js></script><script src=//static.getclicky.com/js></script><script src=/js/udb.js></script></body></html>